<!doctypehtml><html lang="en"><title>HAVIK WebAR</title><meta charset="utf-8"><meta name="viewport"content="width=device-width,initial-scale=1,user-scalable=no"><link rel="shortcut icon" href="favicon.ico" /><link type="text/css"rel="stylesheet"href="files/main.css"><div id="info"><a href="https://www.havik.us/"target="_blank"rel="noopener">HAVIK</a> WebAR Demo<br><br>- Android device: click START AR button to view the experience. Note: if AR is not enabled on your phone, please download <a href="https://play.google.com/store/apps/details?id=com.google.ar.core&hl=en_US&gl=US"target="_blank"rel="noopener">Google Play Services for AR app</a> to enable AR<br><br>- iOS device: please download <a href="https://apps.apple.com/us/app/webxr-viewer/id1295998056"target="_blank"rel="noopener">WebXR Viewer</a> from the app store and use it to scan the QR code to view the AR experience</div><script type="module">import*as THREE from"./build/three.module.js";import{GLTFLoader}from"./examples/jsm/loaders/GLTFLoader.js";import{ARButton}from"./examples/jsm/webxr/ARButton.js";import{KTX2Loader}from"./examples/jsm/loaders/KTX2Loader.js";import{MeshoptDecoder}from"./examples/jsm/libs/meshopt_decoder.module.js";let container,mixer,clock,camera,scene,renderer,controller,reticle,spawnedModel=null,hasSpawned=!1,hitTestSource=null,hitTestSourceRequested=!1;function init(){container=document.createElement("div"),document.body.appendChild(container),scene=new THREE.Scene,clock=new THREE.Clock,camera=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,.001,100);const e=new THREE.HemisphereLight(16777215,16777164,1.5);e.position.set(0,1,1),scene.add(e),renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),renderer.outputEncoding=THREE.sRGBEncoding,renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(window.innerWidth,window.innerHeight),renderer.xr.enabled=!0,container.appendChild(renderer.domElement),document.body.appendChild(ARButton.createButton(renderer,{requiredFeatures:["hit-test"]}));var r=(new KTX2Loader).setTranscoderPath("./examples/js/libs/basis/").detectSupport(renderer);const t=new GLTFLoader;t.setKTX2Loader(r),t.setMeshoptDecoder(MeshoptDecoder),controller=renderer.xr.getController(0),controller.addEventListener("select",function(){reticle.visible&&(hasSpawned?null!==spawnedModel&&(spawnedModel.position.setFromMatrixPosition(reticle.matrix),spawnedModel.position.z-=20):(hasSpawned=!0,t.load("./assets/ARBoothNewTextureCcTcKnKmKe.glb",function(e){var r=e.scene.children[0];r.scale.set(5,5,5),r.rotation.y=THREE.MathUtils.degToRad(-90),r.position.setFromMatrixPosition(reticle.matrix),r.position.z-=20,mixer=new THREE.AnimationMixer(e.scene),mixer.clipAction(e.animations[0]).play(),spawnedModel=r,scene.add(r)},void 0,function(e){console.error(e)})))}),scene.add(controller),reticle=new THREE.Mesh(new THREE.RingGeometry(.15,.2,32).rotateX(-Math.PI/2),new THREE.MeshBasicMaterial),reticle.matrixAutoUpdate=!1,reticle.visible=!1,scene.add(reticle),window.addEventListener("resize",onWindowResize)}function onWindowResize(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}function animate(){requestAnimationFrame(animate);var e=clock.getDelta();mixer&&mixer.update(e),renderer.setAnimationLoop(render)}function render(e,r){if(r){var t=renderer.xr.getReferenceSpace();const n=renderer.xr.getSession();if(!1===hitTestSourceRequested&&(n.requestReferenceSpace("viewer").then(function(e){n.requestHitTestSource({space:e}).then(function(e){hitTestSource=e})}),n.addEventListener("end",function(){hitTestSourceRequested=!1,hitTestSource=null}),hitTestSourceRequested=!0),hitTestSource){r=r.getHitTestResults(hitTestSource);if(r.length){const i=r[0];reticle.visible=!0,reticle.matrix.fromArray(i.getPose(t).transform.matrix)}else reticle.visible=!1}}renderer.render(scene,camera)}init(),animate();</script>